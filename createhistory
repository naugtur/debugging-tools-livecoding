#!/bin/bash

git checkout -f main
git checkout -- .
rm -fr ./src
git tag -d 0
git branch -D demo
git checkout -b demo
git checkout dev .vscode
echo >>.gitignore
echo './history'>>.gitignore
git add -A
git commit -am "tools"
git tag 0
git restore --source dev history
git restore --source dev sample
git restore --source dev package.json
git restore --source dev package-lock.json
git status
mkdir src
git add -A
git status 
git commit -am "sample"


for var in history/*
do
    echo "$var"
    rm -fr ./src/*
    cp -r $var/* ./src/
    message=`cat ./src/COMMIT_MESSAGE`
    tag=`cat ./src/TAG`
    rm ./src/COMMIT_MESSAGE
    rm ./src/TAG
    git add ./src
    git commit -am "$message"
    if [ $tag ]; then
        git tag -d $tag
        git tag $tag
    fi
done

rm -fr history
git checkout 0


